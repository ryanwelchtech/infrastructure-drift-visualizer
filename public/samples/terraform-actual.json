{
  "resources": [
    {
      "type": "aws_vpc",
      "name": "production",
      "config": {
        "id": "vpc-0123456789abcdef0",
        "cidr_block": "10.0.0.0/16",
        "enable_dns_hostnames": true,
        "enable_dns_support": true,
        "tags": {
          "Name": "production-vpc",
          "Environment": "production",
          "ManagedBy": "Terraform"
        }
      },
      "depends_on": [],
      "region": "us-east-1"
    },
    {
      "type": "aws_subnet",
      "name": "public_1a",
      "config": {
        "id": "subnet-0123456789abcdef0",
        "vpc_id": "vpc-0123456789abcdef0",
        "cidr_block": "10.0.1.0/24",
        "availability_zone": "us-east-1a",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "public-subnet-1a",
          "Environment": "production"
        }
      },
      "depends_on": ["aws_vpc.production"],
      "region": "us-east-1"
    },
    {
      "type": "aws_subnet",
      "name": "private_1a",
      "config": {
        "id": "subnet-0123456789abcdef1",
        "vpc_id": "vpc-0123456789abcdef0",
        "cidr_block": "10.0.2.0/24",
        "availability_zone": "us-east-1a",
        "map_public_ip_on_launch": true,
        "tags": {
          "Name": "private-subnet-1a",
          "Environment": "production"
        }
      },
      "depends_on": ["aws_vpc.production"],
      "region": "us-east-1"
    },
    {
      "type": "aws_security_group",
      "name": "web",
      "config": {
        "id": "sg-0123456789abcdef0",
        "name": "web-sg",
        "vpc_id": "vpc-0123456789abcdef0",
        "description": "Security group for web servers",
        "ingress": [
          {
            "from_port": 443,
            "to_port": 443,
            "protocol": "tcp",
            "cidr_blocks": ["0.0.0.0/0"]
          },
          {
            "from_port": 80,
            "to_port": 80,
            "protocol": "tcp",
            "cidr_blocks": ["0.0.0.0/0"]
          },
          {
            "from_port": 22,
            "to_port": 22,
            "protocol": "tcp",
            "cidr_blocks": ["0.0.0.0/0"]
          }
        ],
        "egress": [
          {
            "from_port": 0,
            "to_port": 0,
            "protocol": "-1",
            "cidr_blocks": ["0.0.0.0/0"]
          }
        ]
      },
      "depends_on": ["aws_vpc.production"],
      "region": "us-east-1"
    },
    {
      "type": "aws_instance",
      "name": "web_server",
      "config": {
        "id": "i-0123456789abcdef0",
        "ami": "ami-0abcdef1234567890",
        "instance_type": "t3.large",
        "key_name": "production-key",
        "vpc_security_group_ids": ["sg-0123456789abcdef0"],
        "subnet_id": "subnet-0123456789abcdef0",
        "monitoring": false,
        "tags": {
          "Name": "web-server-1",
          "Environment": "production"
        }
      },
      "depends_on": ["aws_subnet.public_1a", "aws_security_group.web"],
      "region": "us-east-1"
    },
    {
      "type": "aws_db_instance",
      "name": "main",
      "config": {
        "id": "db-0123456789abcdef0",
        "identifier": "db-prod",
        "engine": "postgres",
        "engine_version": "15.4",
        "instance_class": "db.r6g.large",
        "vpc_security_group_ids": ["sg-0123456789abcdef0"],
        "db_subnet_group_name": "prod-db-subnet-group",
        "multi_az": true,
        "storage_encrypted": true,
        "tags": {
          "Name": "main-db",
          "Environment": "production"
        }
      },
      "depends_on": ["aws_subnet.private_1a", "aws_security_group.web"],
      "region": "us-east-1"
    },
    {
      "type": "aws_lambda_function",
      "name": "api_handler",
      "config": {
        "id": "api-handler",
        "function_name": "api-handler-prod",
        "runtime": "nodejs18.x",
        "handler": "index.handler",
        "memory_size": 512,
        "timeout": 60,
        "vpc_config": {
          "subnet_ids": ["subnet-0123456789abcdef1"],
          "security_group_ids": ["sg-0123456789abcdef0"]
        }
      },
      "depends_on": ["aws_subnet.private_1a", "aws_security_group.web"],
      "region": "us-east-1"
    },
    {
      "type": "aws_alb",
      "name": "main",
      "config": {
        "id": "alb-0123456789abcdef0",
        "name": "main-alb",
        "load_balancer_type": "application",
        "scheme": "internet-facing",
        "subnets": ["subnet-0123456789abcdef0"],
        "security_groups": ["sg-0123456789abcdef0"],
        "idle_timeout": 60
      },
      "depends_on": ["aws_subnet.public_1a", "aws_security_group.web"],
      "region": "us-east-1"
    }
  ]
}
