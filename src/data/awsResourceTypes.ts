import { ResourceType } from '@/types/infrastructure';

export const AWS_RESOURCE_TYPES: ResourceType[] = [
  'ec2',
  's3',
  'rds',
  'vpc',
  'subnet',
  'security_group',
  'iam_role',
  'iam_user',
  'iam_policy',
  'lambda',
  'api_gateway',
  'api_gateway_v2',
  'cloudfront',
  'route53',
  'route53_zone',
  'elb',
  'alb',
  'nlb',
  'ecs',
  'eks',
  'fargate',
  'autoscaling',
  'cloudwatch',
  'logs',
  'sqs',
  'sns',
  'kinesis',
  'dynamodb',
  'documentdb',
  'neptune',
  'redshift',
  'elasticache',
  'elasticache_replication_group',
  'mq',
  'mq_broker',
  'efs',
  'fsx',
  'glacier',
  's3_object_lambda',
  'dms',
  'dms_replication_task',
  'transfer',
  'directconnect',
  'vpn',
  'vpc_peering',
  'vpc_endpoint',
  'vpc_flow_log',
  'nat_gateway',
  'internet_gateway',
  'egress_only_gateway',
  'customer_gateway',
  'launch_template',
  'placement_group',
  'key_pair',
  'spot_fleet',
  'dedicated_host',
  'vpc_dhcp_options',
  'vpc_dhcp_options_association',
  'vpc_address',
  'vpc_ipam',
  'vpc_ipam_pool',
  'vpc_ipam_allocation',
  'vpc_ipam_preview',
  'vpc_ipam_scope',
  'kms',
  'secretsmanager',
  'ssm',
  'elastic_beanstalk',
  'glue',
  'athena',
  'quicksight',
  'macie',
  'guardduty',
  'securityhub',
  'config',
  'waf',
  'shield',
  'detective',
  'inspector',
];

export const RESOURCE_TYPE_MAP: Record<string, ResourceType> = {
  'aws_instance': 'ec2',
  'aws_ebs_volume': 'ec2',
  'aws_ebs_snapshot': 'ec2',
  'aws_key_pair': 'key_pair',
  'aws_launch_template': 'launch_template',
  'aws_placement_group': 'placement_group',
  'aws_spot_instance_request': 'ec2',
  'aws_spot_fleet_request': 'spot_fleet',
  'aws_dedicated_host': 'dedicated_host',
  'aws_volume_attachment': 'ec2',
  'aws_s3_bucket': 's3',
  'aws_s3_bucket_object': 's3',
  'aws_s3_bucket_policy': 's3',
  'aws_s3_bucket_public_access_block': 's3',
  'aws_s3_bucket_server_side_encryption_configuration': 's3',
  'aws_s3_bucket_versioning': 's3',
  'aws_s3_bucket_replication': 's3',
  'aws_s3_object_lambda_access_point': 's3_object_lambda',
  'aws_db_instance': 'rds',
  'aws_db_cluster': 'rds',
  'aws_db_subnet_group': 'rds',
  'aws_db_parameter_group': 'rds',
  'aws_db_option_group': 'rds',
  'aws_db_snapshot': 'rds',
  'aws_db_cluster_snapshot': 'rds',
  'aws_rds_global_cluster': 'rds',
  'aws_vpc': 'vpc',
  'aws_vpc_endpoint': 'vpc_endpoint',
  'aws_vpc_peering_connection': 'vpc_peering',
  'aws_vpc_ipam': 'vpc_ipam',
  'aws_vpc_ipam_pool': 'vpc_ipam_pool',
  'aws_vpc_ipam_allocation': 'vpc_ipam_allocation',
  'aws_vpc_ipam_preview': 'vpc_ipam_preview',
  'aws_vpc_ipam_scope': 'vpc_ipam_scope',
  'aws_subnet': 'subnet',
  'aws_security_group': 'security_group',
  'aws_security_group_rule': 'security_group',
  'aws_iam_role': 'iam_role',
  'aws_iam_user': 'iam_user',
  'aws_iam_policy': 'iam_policy',
  'aws_iam_policy_attachment': 'iam_role',
  'aws_iam_access_key': 'iam_user',
  'aws_iam_service_account': 'iam_role',
  'aws_lambda_function': 'lambda',
  'aws_lambda_permission': 'lambda',
  'aws_lambda_event_source_mapping': 'lambda',
  'aws_api_gateway_rest_api': 'api_gateway',
  'aws_api_gateway_resource': 'api_gateway',
  'aws_api_gateway_method': 'api_gateway',
  'aws_api_gateway_deployment': 'api_gateway',
  'aws_api_gateway_stage': 'api_gateway',
  'aws_api_gateway_model': 'api_gateway',
  'aws_api_gateway_authorizer': 'api_gateway',
  'aws_api_gateway_v2_api': 'api_gateway_v2',
  'aws_api_gateway_v2_route': 'api_gateway_v2',
  'aws_api_gateway_v2_integration': 'api_gateway_v2',
  'aws_api_gateway_v2_stage': 'api_gateway_v2',
  'aws_cloudfront_distribution': 'cloudfront',
  'aws_cloudfront_origin_access_identity': 'cloudfront',
  'aws_cloudfront_cache_policy': 'cloudfront',
  'aws_cloudfront_response_headers_policy': 'cloudfront',
  'aws_route53_zone': 'route53_zone',
  'aws_route53_record': 'route53',
  'aws_route53_health_check': 'route53',
  'aws_route53_query_logging_config': 'route53',
  'aws_alb': 'alb',
  'aws_lb': 'alb',
  'aws_lb_target_group': 'alb',
  'aws_lb_listener': 'alb',
  'aws_lb_listener_rule': 'alb',
  'aws_alb_target_group': 'alb',
  'aws_alb_listener': 'alb',
  'aws_alb_listener_rule': 'alb',
  'aws_elb': 'elb',
  'aws_nlb': 'nlb',
  'aws_ecs_cluster': 'ecs',
  'aws_ecs_service': 'ecs',
  'aws_ecs_task_definition': 'ecs',
  'aws_ecs_capacity_provider': 'ecs',
  'aws_ecs_task_set': 'ecs',
  'aws_eks_cluster': 'eks',
  'aws_eks_node_group': 'eks',
  'aws_eks_fargate_profile': 'eks',
  'aws_ecs_cluster_capacity_provider_associations': 'ecs',
  'aws_autoscaling_group': 'autoscaling',
  'aws_autoscaling_policy': 'autoscaling',
  'aws_autoscaling_schedule': 'autoscaling',
  'aws_launch_configuration': 'autoscaling',
  'aws_cloudwatch_metric_alarm': 'cloudwatch',
  'aws_cloudwatch_dashboard': 'cloudwatch',
  'aws_cloudwatch_log_group': 'logs',
  'aws_cloudwatch_log_metric_filter': 'logs',
  'aws_cloudwatch_log_resource_policy': 'logs',
  'aws_sqs_queue': 'sqs',
  'aws_sqs_queue_policy': 'sqs',
  'aws_sqs_queue_redrive_policy': 'sqs',
  'aws_sns_topic': 'sns',
  'aws_sns_topic_policy': 'sns',
  'aws_sns_subscription': 'sns',
  'aws_kinesis_stream': 'kinesis',
  'aws_kinesis_firehose_delivery_stream': 'kinesis',
  'aws_kinesis_analytics_application': 'kinesis',
  'aws_dynamodb_table': 'dynamodb',
  'aws_dynamodb_global_table': 'dynamodb',
  'aws_dynamodb_table_item': 'dynamodb',
  'aws_dynamodb_backup': 'dynamodb',
  'aws_dynamodb_replica': 'dynamodb',
  'aws_docdb_cluster': 'documentdb',
  'aws_docdb_instance': 'documentdb',
  'aws_docdb_subnet_group': 'documentdb',
  'aws_docdb_cluster_snapshot': 'documentdb',
  'aws_neptune_cluster': 'neptune',
  'aws_neptune_instance': 'neptune',
  'aws_neptune_subnet_group': 'neptune',
  'aws_redshift_cluster': 'redshift',
  'aws_redshift_parameter_group': 'redshift',
  'aws_redshift_subnet_group': 'redshift',
  'aws_redshift_snapshot_copy_grant': 'redshift',
  'aws_elasticache_cluster': 'elasticache',
  'aws_elasticache_replication_group': 'elasticache_replication_group',
  'aws_elasticache_subnet_group': 'elasticache',
  'aws_elasticache_parameter_group': 'elasticache',
  'aws_elasticache_security_group': 'elasticache',
  'aws_mq_broker': 'mq_broker',
  'aws_mq_configuration': 'mq',
  'aws_mq_user': 'mq',
  'aws_efs_file_system': 'efs',
  'aws_efs_mount_target': 'efs',
  'aws_efs_access_point': 'efs',
  'aws_efs_backup_policy': 'efs',
  'aws_fsx_windows_file_system': 'fsx',
  'aws_fsx_lustre_file_system': 'fsx',
  'aws_fsx_ontap_file_system': 'fsx',
  'aws_fsx_openzfs_file_system': 'fsx',
  'aws_glacier_vault': 'glacier',
  'aws_glacier_vault_lock': 'glacier',
  'aws_dms_replication_instance': 'dms',
  'aws_dms_replication_task': 'dms_replication_task',
  'aws_dms_endpoint': 'dms',
  'aws_dms_event_subscription': 'dms',
  'aws_dms_subnet_group': 'dms',
  'aws_transfer_server': 'transfer',
  'aws_transfer_user': 'transfer',
  'aws_transfer_ssh_key': 'transfer',
  'aws_transfer_connector': 'transfer',
  'aws_directconnect_connection': 'directconnect',
  'aws_directconnect_lag': 'directconnect',
  'aws_directconnect_gateway': 'directconnect',
  'aws_directconnect_gateway_association': 'directconnect',
  'aws_directconnect_hosted_transit_virtual_interface': 'directconnect',
  'aws_directconnect_hosted_connection': 'directconnect',
  'aws_vpn_connection': 'vpn',
  'aws_vpn_connection_route': 'vpn',
  'aws_vpc_dhcp_options': 'vpc_dhcp_options',
  'aws_vpc_dhcp_options_association': 'vpc_dhcp_options_association',
  'aws_vpc_address': 'vpc_address',
  'aws_egress_only_internet_gateway': 'egress_only_gateway',
  'aws_customer_gateway': 'customer_gateway',
  'aws_internet_gateway': 'internet_gateway',
  'aws_nat_gateway': 'nat_gateway',
  'aws_vpc_flow_log': 'vpc_flow_log',
  'aws_kms_key': 'kms',
  'aws_kms_alias': 'kms',
  'aws_kms_grant': 'kms',
  'aws_secretsmanager_secret': 'secretsmanager',
  'aws_secretsmanager_secret_version': 'secretsmanager',
  'aws_ssm_parameter': 'ssm',
  'aws_ssm_document': 'ssm',
  'aws_ssm_activation': 'ssm',
  'aws_ssm_maintenance_window': 'ssm',
  'aws_ssm_patch_baseline': 'ssm',
  'aws_elastic_beanstalk_application': 'elastic_beanstalk',
  'aws_elastic_beanstalk_environment': 'elastic_beanstalk',
  'aws_glue_catalog_database': 'glue',
  'aws_glue_catalog_table': 'glue',
  'aws_glue_job': 'glue',
  'aws_glue_trigger': 'glue',
  'aws_glue_crawler': 'glue',
  'aws_glue_dev_endpoint': 'glue',
  'aws_glue_ml_transform': 'glue',
  'aws_athena_named_query': 'athena',
  'aws_athena_workgroup': 'athena',
  'aws_athena_database': 'athena',
  'aws_quicksight_user': 'quicksight',
  'aws_quicksight_group': 'quicksight',
  'aws_quicksight_dashboard': 'quicksight',
  'aws_quicksight_analysis': 'quicksight',
  'aws_quicksight_template': 'quicksight',
  'aws_macie2_account': 'macie',
  'aws_macie2_findings_filter': 'macie',
  'aws_macie2_member': 'macie',
  'aws_guardduty_detector': 'guardduty',
  'aws_guardduty_ip_set': 'guardduty',
  'aws_guardduty_threat_intel_set': 'guardduty',
  'aws_guardduty_member': 'guardduty',
  'aws_guardduty_invite_accepter': 'guardduty',
  'aws_securityhub_account': 'securityhub',
  'aws_securityhub_insight': 'securityhub',
  'aws_securityhub_member': 'securityhub',
  'aws_securityhub_product_subscription': 'securityhub',
  'aws_securityhub_standards_subscription': 'securityhub',
  'aws_config_config_rule': 'config',
  'aws_config_configuration_recorder': 'config',
  'aws_config_delivery_channel': 'config',
  'aws_config_aggregator': 'config',
  'aws_config_conformance_pack': 'config',
  'aws_wafv2_web_acl': 'waf',
  'aws_wafv2_rule_group': 'waf',
  'aws_wafv2_ip_set': 'waf',
  'aws_wafv2_regex_pattern_set': 'waf',
  'aws_wafv2_managed_rule_set': 'waf',
  'aws_wafv2_web_acl_association': 'waf',
  'aws_shield_protection': 'shield',
  'aws_shield_protection_health_check_association': 'shield',
  'aws_shield_drt_access_log_bucket_association': 'shield',
  'aws_detective_graph': 'detective',
  'aws_detective_member': 'detective',
  'aws_detective_invitation_accepter': 'detective',
  'aws_inspector2_enabler': 'inspector',
  'aws_inspector2_member': 'inspector',
  'aws_inspector2_finding_aggregation': 'inspector',
};

export function mapTerraformTypeToResourceType(terraformType: string): ResourceType {
  return RESOURCE_TYPE_MAP[terraformType.toLowerCase()] || terraformType.toLowerCase().replace('aws_', '').replace(/_/g, '-') as ResourceType;
}

export function getResourceTypeLabel(type: ResourceType): string {
  const labels: Record<ResourceType, string> = {
    'ec2': 'EC2 Instance',
    's3': 'S3 Bucket',
    'rds': 'RDS Database',
    'vpc': 'VPC',
    'subnet': 'Subnet',
    'security_group': 'Security Group',
    'iam_role': 'IAM Role',
    'iam_user': 'IAM User',
    'iam_policy': 'IAM Policy',
    'lambda': 'Lambda Function',
    'api_gateway': 'API Gateway (REST)',
    'api_gateway_v2': 'API Gateway (HTTP)',
    'cloudfront': 'CloudFront Distribution',
    'route53': 'Route 53 Record',
    'route53_zone': 'Route 53 Hosted Zone',
    'elb': 'Classic Load Balancer',
    'alb': 'Application Load Balancer',
    'nlb': 'Network Load Balancer',
    'ecs': 'ECS Cluster',
    'eks': 'EKS Cluster',
    'fargate': 'Fargate Task',
    'autoscaling': 'Auto Scaling Group',
    'cloudwatch': 'CloudWatch Alarm',
    'logs': 'CloudWatch Logs',
    'sqs': 'SQS Queue',
    'sns': 'SNS Topic',
    'kinesis': 'Kinesis Stream',
    'dynamodb': 'DynamoDB Table',
    'documentdb': 'DocumentDB Cluster',
    'neptune': 'Neptune Cluster',
    'redshift': 'Redshift Cluster',
    'elasticache': 'ElastiCache Cluster',
    'elasticache_replication_group': 'ElastiCache Replication Group',
    'mq': 'MQ Broker',
    'mq_broker': 'MQ Broker',
    'efs': 'EFS File System',
    'fsx': 'FSx File System',
    'glacier': 'Glacier Vault',
    's3_object_lambda': 'S3 Object Lambda',
    'dms': 'DMS Replication Instance',
    'dms_replication_task': 'DMS Replication Task',
    'transfer': 'Transfer Server',
    'directconnect': 'Direct Connect',
    'vpn': 'VPN Connection',
    'vpc_peering': 'VPC Peering',
    'vpc_endpoint': 'VPC Endpoint',
    'vpc_flow_log': 'VPC Flow Log',
    'nat_gateway': 'NAT Gateway',
    'internet_gateway': 'Internet Gateway',
    'egress_only_gateway': 'Egress Only Gateway',
    'customer_gateway': 'Customer Gateway',
    'launch_template': 'Launch Template',
    'placement_group': 'Placement Group',
    'key_pair': 'Key Pair',
    'spot_fleet': 'Spot Fleet',
    'dedicated_host': 'Dedicated Host',
    'vpc_dhcp_options': 'VPC DHCP Options',
    'vpc_dhcp_options_association': 'VPC DHCP Options Association',
    'vpc_address': 'VPC Elastic IP',
    'vpc_ipam': 'VPC IPAM',
    'vpc_ipam_pool': 'VPC IPAM Pool',
    'vpc_ipam_allocation': 'VPC IPAM Allocation',
    'vpc_ipam_preview': 'VPC IPAM Preview',
    'vpc_ipam_scope': 'VPC IPAM Scope',
    'kms': 'KMS Key',
    'secretsmanager': 'Secrets Manager',
    'ssm': 'Systems Manager',
    'elastic_beanstalk': 'Elastic Beanstalk',
    'glue': 'Glue',
    'athena': 'Athena',
    'quicksight': 'QuickSight',
    'macie': 'Macie',
    'guardduty': 'GuardDuty',
    'securityhub': 'Security Hub',
    'config': 'Config',
    'waf': 'WAF',
    'shield': 'Shield',
    'detective': 'Detective',
    'inspector': 'Inspector',
  };
  return labels[type] || type.toUpperCase().replace(/-/g, ' ');
}

export function getResourceIcon(type: ResourceType): string {
  const icons: Record<ResourceType, string> = {
    'ec2': 'Server',
    's3': 'Database',
    'rds': 'Database',
    'vpc': 'Network',
    'subnet': 'Network',
    'security_group': 'Shield',
    'iam_role': 'User',
    'iam_user': 'User',
    'iam_policy': 'FileText',
    'lambda': 'Zap',
    'api_gateway': 'Gateway',
    'api_gateway_v2': 'Gateway',
    'cloudfront': 'Globe',
    'route53': 'Globe',
    'route53_zone': 'Globe',
    'elb': 'Share2',
    'alb': 'Share2',
    'nlb': 'Share2',
    'ecs': 'Box',
    'eks': 'Box',
    'fargate': 'Box',
    'autoscaling': 'ArrowUpDown',
    'cloudwatch': 'Eye',
    'logs': 'FileText',
    'sqs': 'Inbox',
    'sns': 'Bell',
    'kinesis': 'Activity',
    'dynamodb': 'Table',
    'documentdb': 'Database',
    'neptune': 'Database',
    'redshift': 'BarChart2',
    'elasticache': 'Box',
    'elasticache_replication_group': 'Box',
    'mq': 'MessageSquare',
    'mq_broker': 'MessageSquare',
    'efs': 'Folder',
    'fsx': 'Folder',
    'glacier': 'Archive',
    's3_object_lambda': 'Database',
    'dms': 'RefreshCw',
    'dms_replication_task': 'RefreshCw',
    'transfer': 'Upload',
    'directconnect': 'Cable',
    'vpn': 'Lock',
    'vpc_peering': 'Link',
    'vpc_endpoint': 'Link',
    'vpc_flow_log': 'Activity',
    'nat_gateway': 'Network',
    'internet_gateway': 'Globe',
    'egress_only_gateway': 'Network',
    'customer_gateway': 'Network',
    'launch_template': 'FileText',
    'placement_group': 'Grid',
    'key_pair': 'Key',
    'spot_fleet': 'Server',
    'dedicated_host': 'Server',
    'vpc_dhcp_options': 'Settings',
    'vpc_dhcp_options_association': 'Link',
    'vpc_address': 'MapPin',
    'vpc_ipam': 'Settings',
    'vpc_ipam_pool': 'Database',
    'vpc_ipam_allocation': 'MapPin',
    'vpc_ipam_preview': 'Eye',
    'vpc_ipam_scope': 'Settings',
    'kms': 'Key',
    'secretsmanager': 'Lock',
    'ssm': 'Settings',
    'elastic_beanstalk': 'Box',
    'glue': 'Database',
    'athena': 'BarChart2',
    'quicksight': 'BarChart2',
    'macie': 'Eye',
    'guardduty': 'Shield',
    'securityhub': 'Shield',
    'config': 'Settings',
    'waf': 'Shield',
    'shield': 'Shield',
    'detective': 'Search',
    'inspector': 'Search',
  };
  return icons[type] || 'Server';
}
